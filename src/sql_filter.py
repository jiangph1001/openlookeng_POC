# -*- coding: utf-8 -*-
# toDateTime函数映射失败，暂时屏蔽
def exclude_toDateTime(mode,sql):
    keys = list(sql.keys())
    if mode == "ch":
        for key in keys:
            if "toDateTime" in sql[key]:
                sql.pop(key)
    else:  # mode == "ol"
        for key in keys:
            if "from_unixtime" in sql[key]:
                sql.pop(key)
    return sql



def explain_test(sql1):
    run_keys = ['Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8','Q9','Q10']
    sql = {}
    for key in run_keys:
        sql[key] = sql1[key]
    return sql

def test_exclude_toDateTime(mode,sql1):
    run_keys = ['Q1', 'Q2', 'Q3', 'Q4', 'Q5', 'Q6', 
                'Q7', 'Q8', 'Q9', 'Q10', 'Q11', 'Q12', 'Q13', 
                'Q14', 'Q15', 'Q16', 'Q17', 'Q18', 'Q19', 'Q20',
                 'Q21', 'Q22', 'Q23', 'Q24', 'Q25', 'Q26', 'Q27', 
                 'Q28', 'Q29', 'Q30', 'Q31', 'Q32', 'Q33', 'Q34',
                  'Q35', 'Q36', 'Q37', 'Q72', 'Q127', 'Q128', 'Q129',
                   'Q130', 'Q131', 'Q132', 'Q133', 'Q134', 'Q135', 
                   'Q136', 'Q137', 'Q138', 'Q139', 'Q140', 'Q141', 
                   'Q142', 'Q143', 'Q144', 'Q145', 'Q146', 'Q147', 
                   'Q148', 'Q149', 'Q150', 'Q151', 'Q152', 'Q153', 
                   'Q154', 'Q155', 'Q156', 'Q157', 'Q158', 'Q159', 
                   'Q160', 'Q161', 'Q162', 'Q163', 'Q164', 'Q165', 
                   'Q166', 'Q167', 'Q168', 'Q169', 'Q170', 'Q171', 
                   'Q172', 'Q173', 'Q174', 'Q175', 'Q176', 'Q177', 
                   'Q178', 'Q179', 'Q182', 'Q183', 'Q184', 'Q186', 
                   'Q187', 'Q188', 'Q189', 'Q190', 'Q191', 'Q192', 
                   'Q193', 'Q194', 'Q195', 'Q196', 'Q197', 'Q198', 
                   'Q199', 'Q200', 'Q201', 'Q202', 'Q205', 'Q206', 
                   'Q207', 'Q208', 'Q209', 'Q210', 'Q211', 'Q212', 
                   'Q213', 'Q214', 'Q215', 'Q216', 'Q217', 'Q218', 
                   'Q219', 'Q220', 'Q221', 'Q222', 'Q223', 'Q224', 
                   'Q225', 'Q226', 'Q227', 'Q228', 'Q229', 'Q230', 
                   'Q231', 'Q232', 'Q233', 'Q234', 'Q235', 'Q236', 
                   'Q237', 'Q238', 'Q239', 'Q240', 'Q241', 'Q242', 
                   'Q243', 'Q244', 'Q245', 'Q246', 'Q247', 'Q248', 
                   'Q249', 'Q250', 'Q251', 'Q252', 'Q253', 'Q254', 
                   'Q255', 'Q256', 'Q257', 'Q258', 'Q259', 'Q260', 
                   'Q261', 'Q262', 'Q263', 'Q264', 'Q265', 'Q266', 
                   'Q267', 'Q268', 'Q269', 'Q270', 'Q271', 'Q272', 
                   'Q273', 'Q274', 'Q275', 'Q276', 'Q277', 'Q278', 
                   'Q279', 'Q280', 'Q281', 'Q282', 'Q283', 'Q284', 
                   'Q285', 'Q286', 'Q287', 'Q288', 'Q289', 'Q290', 
                   'Q291', 'Q292', 'Q293', 'Q294', 'Q295', 'Q296', 
                   'Q297', 'Q298', 'Q299', 'Q300', 'Q301', 'Q302', 
                   'Q303', 'Q304', 'Q305', 'Q306', 'Q307', 'Q308', 
                   'Q309', 'Q310', 'Q311', 'Q312', 'Q313', 'Q314', 
                   'Q315', 'Q316', 'Q317']
    
    keys = list(sql1.keys())
    for key in keys:
        if key not in run_keys:
            sql1.pop(key)
    return sql1